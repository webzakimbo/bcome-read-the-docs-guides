.. meta::
   :description lang=en: Overidding identifiers


**********************
Overidding identifiers
**********************

Within a given inventory you may provide a regular expression to alter the identifiers (i.e. the names) of your servers as they appear and are referenced within Bcome.

This is useful when you have server names that include metadata that you want to strip within Bcome.

The regular expression must match the server name, and include a single selector that is used to replace the orignal name.

In the following example, I have setup two GCP inventories. Both return the same servers, but one inventory alters their names with an override removing the prefix "prod_net_".

Tree Hierarchy
==============

The tree hierarchy below is generated by invoking Bcome's ``tree`` command:

.. code-block:: bash

      ▐▆   Namespace tree wbz
      │
      └───╸ collection gcp
                ├───╸ inventory not_overriden
                │         ├───╸ server prod_net_bastion
                │         ├───╸ server prod_net_puppet
                │         └───╸ server prod_net_wbzsite_app_sq6v
                │
                └───╸ inventory overriden
                          ├───╸ server bastion
                          ├───╸ server puppet
                          └───╸ server wbzsite_app_sq6v


networks.yml file
=================

.. code-block:: yaml

   ---
   wbz:
     type: collection
     description: Entire WBZ estate
     ssh_settings: {}

   wbz:gcp:
     type: collection
     description: WBZ gcp estate
     network:
       type: gcp
       project: wbznet
       authentication_scheme: oauth
       secrets_filename: wbz-net-oauth-secrets.json
       service_scopes:
       - https://www.googleapis.com/auth/compute.readonly
       - https://www.googleapis.com/auth/cloud-platform

   wbz:gcp:not_overriden:
     type: inventory
     description: GCP Production
     ssh_settings:
       proxy:
         - host_lookup: by_bcome_namespace
           namespace: gcp:not_overriden:prod_net_bastion
     network:
       filters: status:running AND labels.environment=prod-net
       zone: europe-west1-b

   wbz:gcp:overriden:
     type: inventory
     description: GCP Production
     ssh_settings:
       proxy:
         - host_lookup: by_bcome_namespace
           namespace: gcp:overriden:bastion
     network:
       filters: status:running AND labels.environment=prod-net
       zone: europe-west1-b

     override_identifier: "prod_net_(.+)"

.. note:: 

   You may override identifiers within namespaces of type ``inventory``, or ``inventory-subselect``

   Any reference to an overriden server uses the overriden name. See the proxy referenced by "gcp:overriden:bastion" above as an example.

Ascii Cast
==========

  TODO: ascii_casts/override-identifier.cast
